\documentclass[uplatex,dvipdfmx]{ujarticle}
\input{mylib.tex}
\usepackage{tikz}
\usetikzlibrary{positioning} % これを必ず追加
\begin{document}

\title{ESP32+FluidNC+Raspberry Pi 4B+CNCjs レシピ本}
\author{文責:小木勇輝}
\date{\today}
\maketitle

\tableofcontents


\section{概念設計図}

本章では、Raspberry Pi 4B上でCNCjs(用語等は後述)を動作させ、USB経由でESP32(FluidNC)を直接制御する構成の全体像を示す。高校卒業直後の初学者を想定し、Linuxやモーション制御の基礎から説明する。

\subsection{全体構成}

Raspberry Pi 4B上でCNCjsを起動し、USB接続されたESP32(FluidNC)に対しG-codeを送信する。ESP32はモーター制御信号(STEP/DIR/EN)をステッピングドライバへ出力し、ドライバはステッピングモーターを駆動する。

\begin{figure}[h]
\centering
\begin{tikzpicture}[
  font=\small,
  node distance=23mm,
  box/.style={draw, minimum width=20mm, minimum height=12mm, align=center, rounded corners=2pt}
]
\node[box] (raspi) {Raspberry Pi 4B\\CNCjs};
\node[box, right=of raspi] (esp32) {ESP32\\FluidNC};
\node[box, right=of esp32] (driver) {ステッピング\\ドライバ};
\node[box, right=of driver] (motor) {ステッピング\\モーター};

\draw[->] (raspi) -- node[above]{USB} (esp32);
\draw[->] (esp32) -- node[above]{STEP DIR EN} (driver);
\draw[->] (driver) -- node[above]{回転駆動} (motor);
\end{tikzpicture}
\caption{Raspberry Pi 直結の最小構成}
\end{figure}

\subsection{必要構成要素}
\begin{itemize}
    \item Raspberry Pi 4B(4GB)本体（CNCjs動作用）
    \item ESP32ボード（FluidNCファームウェア書き込み済み）
    \item ステッピングドライバ（TB6600など､3A4線バイポーラ出力に対応したもの）
    \item ステッピングモーター（NEMA17/23など）
    \item スピンドルモーター (ER25コレットに対応したもの)
    \item 電源（モーター駆動用 24V系 2つ、Raspberry Pi/ESP32用 5V系）
    \item USBケーブル（Raspberry PiとESP32の接続用）
\end{itemize}

\subsection{信号と電力の流れ}
\begin{itemize}
    \item 信号経路: Raspberry Pi (CNCjs) $\to$ ESP32 (FluidNC) $\to$ ステッピングドライバ $\to$ モーター
    \item 電力系統: 24V系(モーター/ドライバ駆動), 5V系(Raspberry Pi/ESP32駆動)
\end{itemize}

\subsection{ソフトウェア構成}
\begin{itemize}
    \item Raspberry Pi OS:Raspberry PiのOS｡Mac OSの遠い親戚｡
    \item CNCjs: ブラウザベースのCNC操作UI。Raspberry Pi上で動作。
    \item FluidNC: ESP32上で動作するCNC制御ファームウェア。G-codeを解釈しモーション制御信号を生成。
\end{itemize}

\subsection{用語集}
末尾の｢おまけ｣欄を参照すること｡

\subsection{最低限調べておいてほしいこと}

本構成を安全かつ効率的に理解し運用するため、以下の基礎事項は事前に調べておくことを推奨する。いずれも高度な専門書を読む必要はないが、概要と主要用語を把握しておくべきである。

\begin{description}
  \item[Linuxとは何か]  
    オープンソースのUNIX系オペレーティングシステムであり、Raspberry Pi OSもこれに属する。ファイルシステムの階層構造、ユーザーと権限の概念、パッケージマネージャ(例: \texttt{apt})、コマンドライン操作(CLI)などの基本を理解しておくこと。
  
  \item[Raspberry Piとは何か]  
    ARM系プロセッサを搭載した小型シングルボードコンピュータであり、低消費電力でLinuxを動作させられる。本構成ではCNCjsのホストとして使用する。GPIO端子やUSBポートなどの基本的なハード構造も確認しておくこと。

  \item[高校電磁気の復習]  
    直流回路のオームの法則($V=IR$)、抵抗・コイル・コンデンサの基本特性、電力計算($P=VI$)、直列/並列接続の違い、電流と磁界の関係、誘導起電力の概念など。ステッピングモーターやドライバの動作理解に不可欠である。

  \item[ステッピングモーターとは何か]  
    電気パルスの入力に応じて一定角度ずつ回転するモーター。1回転あたりのステップ数、マイクロステップ制御、保持トルク、脱調の概念を把握すること。STEP/DIR信号と回転方向・回転量の関係も確認する。
  
    \item[CNCによる死亡事故例やヒヤリハット]  
    CNC装置は強力な駆動系を持ち、加工対象や工具が高速で移動するため、不適切な操作や安全管理不足により死亡事故や重大な負傷が発生している。過去には回転工具への巻き込まれ、破損工具の飛散、固定不良材料の射出、制御系誤動作による衝突などが報告されている。実際の事故事例やヒヤリハット事例を調べ、危険要因とその防止策を理解しておくこと。非常停止(E-Stop)や安全カバーの有効性についても確認する。


\end{description}

\subsection{安全留意事項}
\begin{itemize}
    \item モーター動作中は手や物を可動部に近づけない。
    \item 電源投入前に配線の正誤と固定状態を確認する。
    \item 電源系は系統ごとにヒューズを設ける。
    \item 手袋をつけてNCを稼働させない｡
\end{itemize}

\section{セットアップ編}

\subsection{ESP32ボードの準備とファーム書き込み}

CNC用モーションコントローラとしてESP32を用いる。ファームウェアはFluidNCを採用する。初期導入はPC上のGoogle ChromeからFluidNC公式のオンラインインストーラを用いる。Web Serial APIを使うためChromeを前提とする。

手順の概観は次の通り。
\begin{enumerate}
\item ESP32をUSBでPCに接続する（給電はPC側/基板側の二冗長系で行う）。
\item Google ChromeでFluidNC Web Installerを開き、Connectで該当シリアルポートを選択する。
\item InstallからLatestビルド（Wi-Fi有効版）を選択して書き込む。\footnote{運用ではWi-Fiは使わない。導入や更新時のみ使う方針とする。}
\item 書き込み完了後、\textbf{インストーラの「Config」（または「Files」）欄}から \texttt{config.yaml} を新規作成する。基本パラメータは後で対話的に調整する（手入力でYAMLを記入せず、インストーラ側で編集・保存する）。
\end{enumerate}

注意点として、各軸のSTEP/DIR/ENのピン割付は、ESP32で\textbf{出力に使ってよいGPIO}を選ぶ。ブートストラップ用のストラッピングピン（GPIO0, 2, 5, 12, 15）やフラッシュ接続ピン（GPIO6〜11）、入力専用ピン（GPIO34〜39）は避ける。UARTのTX/RX（GPIO1/3）も原則避ける。割付は後述の設定方針と合わせて決定する。ピン番号は必ず最新の情報を確認すること｡



\subsection{FluidNCの基本設定（Config欄で行う方針）}

本書の\textbf{基本パラメータを信用せず}、FluidNC Web Installerの\textbf{Config欄から対話的に調整}する。理由は、機械固有の要素（スクリューピッチ、マイクロステップ、剛性、負荷、ドライバ仕様）が初期値を大きく左右するためである。次の考え方で進める。

\subsubsection*{設定の流れ（対話的チューニング）}
\begin{enumerate}
\item 軸とモータの論理構成を定義する（X/Y/Z/A、スレーブ軸の有無など）。
\item 各軸の\textbf{ピン割付}を決める。前節の\textbf{使用可能GPIOの制約}を満たす組合せを選ぶ。
\item \textbf{steps\_per\_mm}(例:320steps/mm)は実測で校正する。適当な手段での測長を繰り返し、誤差を詰める。
\item \textbf{max\_rate}と\textbf{acceleration}は安全側から立ち上げ、脱調・共振・発熱を観察しつつ段階的に上げる。
\item 方向反転やリミット/プローブ極性は、実機の挙動に合わせて修正する。
\end{enumerate}

\noindent 補足: Config欄はWeb UIでの保存を前提とする。エディタでのテキスト貼付は避ける。

\subsection{Raspberry Pi 4BへのCNCjs導入（デスクトップ版OS + 公式Dockerfile）}

CNCjsはWebベースのG-code送受信/UIであり、Raspberry Pi 4Bで常用する。OSは\textbf{Raspberry Pi OS（64-bit, Desktop版）}を用いる。導入時のみWi-Fiを有効化し、\textbf{運用は有線（USB/有線LAN）}とする。「電プチ」（突然の電源断）対策として Overlay File System を有効化する運用を推奨する。

\subsubsection*{OSインストール（Raspberry Pi Imager）}
\begin{enumerate}
\item PCでRaspberry Pi Imagerを起動し、OSは\textbf{Raspberry Pi OS (64-bit) with desktop}を選ぶ。
\item Advanced Settings（歯車）で、ホスト名／ロケール、\textbf{SSH有効化}、\textbf{Wi-Fi設定（導入時のみ使用）}など好みの設定を事前指定して書き込む。
\item 初回起動後、必要なパッケージを更新する。
\end{enumerate}

\begin{lstlisting}[caption=初期パッケージ導入（APT）, label=code:apt-init, language=bash]
# Raspberry Pi OSの更新
sudo apt update
sudo apt -y full-upgrade

# 導入に使うツール群
sudo apt -y install git curl build-essential 

#Dockerのインストール､公式HPを参照
curl -sSL https://get.docker.com | sh
sudo docker ps

#再起動
sudo reboot now
\end{lstlisting}

\subsubsection*{電プチ対策（Overlay File System）}
Raspberry Pi OSは\texttt{raspi-config}から\textbf{Overlay File System}を有効化できる。運用中はrootfsを実質Read-Only化し、変更はRAM上に乗せる。設定変更や更新時は一時的にこれを無効化して再起動する運用にする。\\
\emph{Raspberry Piは正常にシャットダウンされないと高確率でOSのデータが吹き飛ぶ｡悲しい思いをしたくなければこの項を実行すること｡}

\begin{lstlisting}[caption=OverlayFSの有効化（対話/非対話の例）, label=code:overlay, language=bash]
# 対話UIで行う方法（raspi-config）

sudo raspi-config # Performance Options -> Overlay File System -> Enable
# 非対話UIで行う方法（新しめのraspi-configで有効）

sudo raspi-config nonint enable_overlayfs
sudo reboot
\end{lstlisting}

\subsubsection*{CNCjsの導入（公式Dockerfileを用いる）}

公式リポジトリのDockerfileを用いて\textbf{Dockerイメージをローカルビルド}し、コンテナとして常駐運用する。公式Dockerfileは\texttt{dist/cncjs}の成果物を前提とするため、\textbf{先にNode/Yarnでビルドする}。

\paragraph{1) CNCjsのビルド（dist生成）} 
このように行う｡
\begin{lstlisting}[caption=Node/Yarnでフロントをビルド（Pi上で可）, label=code:build-dist, language=bash]
Node 18系を前提（bookworm既定のnodejsで可。必要ならNodeSource等を使用）

sudo apt -y install nodejs npm
sudo npm -g install yarn

git clone https://github.com/cncjs/cncjs.git
cd cncjs
yarn install
yarn run build # dist/cncjs が生成される
\end{lstlisting}
\newpage
\paragraph{2) 公式Dockerfileでイメージ化}
このように行う｡
\begin{lstlisting}[caption=Dockerビルドと起動, label=code:docker-run, language=bash]
リポジトリ直下にある公式Dockerfileを使用

docker build -t cncjs:local -f Dockerfile .
デフォルトExposeは 8000。ホスト8080に割り当てる例。
/dev/ttyUSB* (or /dev/ttyACM*) をコンテナへ渡す

docker run -d --name cncjs
--restart=unless-stopped
--device /dev/ttyUSB0
-p 8080:8000 cncjs:local
\end{lstlisting}

\paragraph{3) 起動・アクセス・運用方針}
\begin{itemize}
\item ブラウザから \texttt{http://<raspi-ip>:8080/} にアクセスし、CNCjs UIを操作する。ブラウザはGoogle Chromeを推奨する。
\item ESP32はUSB直結し、CNCjsのポート選択で \texttt{/dev/ttyUSB*} または \texttt{/dev/ttyACM*} を選ぶ。
\item 運用は有線前提、Wi-Fiは基本無効化（導入・更新時のみ有効）。
\end{itemize}

\begin{lstlisting}[caption=systemdで自動起動（コンテナを常駐させる例）, label=code:systemd, language=bash]
/etc/systemd/system/cncjs.service

[Unit]
Description=CNCjs container
After=network-online.target docker.service
Wants=docker.service

[Service]
Restart=always
ExecStart=/usr/bin/docker start -a cncjs
ExecStop=/usr/bin/docker stop cncjs

[Install]
WantedBy=multi-user.target
有効化

sudo systemctl daemon-reload
sudo systemctl enable --now cncjs
\end{lstlisting}

\section{機械構築・接続編}

本節では、本CNC制御システムの機械構築と配線について述べる。


\subsection{必要部品と仕様確認}

本システムは制御系と駆動系が分離される。制御系にはESP32マイコン、ステッピングモータドライバ、Raspberry Pi 4B（CNCjs実行用）、制御系電源ユニット(DC5V､DC3.3Vのもの)を用いる。駆動系にはステッピングモータと伝達機構（リードスクリュー）､駆動系電源ユニット(DC12-24V)を用いる。ステッピングモータは株式会社オオツカと相談して仕様（トルク、定格電流、保持トルク）を決定する。安全系には非常停止スイッチ、ヒューズを備えるべきである。

現状、スピンドルは制御系と完全に分離されており、独立電源で運用されている。リミットスイッチは物理的には設置済みだが未接続であり、Zプローブは搭載していない。

\subsection{配線計画と電源構成}

配線計画では「系統分離」と「耐環境性」を重視する。モータ用電源、制御系電源、スピンドル電源は物理的に分離し、相互にノイズが回り込まないようにする。モータドライバは典型的にフォトカプラ入力を備えるため、ESP32側のGNDとモータ側のGNDを共通化する必要はない。

事実上の屋外設置である点を考慮し、耐候性のある屋外用ケーブル（ビニルキャブタイヤケーブルVCT、耐UVシース付きケーブルなど）を使用する。信号線とモータ線は別ルートで配線し、筐体に導入する。整備性､可用性､信頼性の観点から､可能な限りコネクタの数が少ないことが好ましい｡

\subsection{ステッピングモータとドライバ接続}

モータには4本の電源線があり、A+/A-/B+/B-の順に接続する。配線色はメーカーにより異なるため、付属資料または導通試験により確認する。片方の相を逆接続することにより回転方向が逆転する｡

ドライバ側では、電源入力（例: 24VDC）とモータ出力端子のほか、STEP/DIR/EN信号入力端子がある。これらはESP32のGPIOピンから出力され、ドライバのフォトカプラ入力に接続する。フォトカプラの＋端子に信号線、−端子にESP32側のGNDを接続する。マイクロステップ設定はDIPスイッチで行い、機械分解能と加工速度に応じて選択する（例: 1/32ステップ設定）。電流制限もDIPスイッチで設定し、モータ定格電流の90％程度に設定するのが一般的である。

\subsection{リミットスイッチ}

X/Y/A軸にリミットスイッチが設置されているが、現状未接続であるため、FluidNCではソフトリミットまたは手動位置決めで運用する。将来接続する場合はNC（常閉）接点を用い、配線には屋外用シールドケーブルを採用する。ノイズ防止のため、信号線はツイストペア構造が望ましい。

\subsection{Zプローブ}

現状Zプローブは搭載していない。ツール長補正は手動で行い、相対座標系のZ位置を調整する。

\subsection{スピンドル}

スピンドルは完全に制御系から分離され、独立電源で運用する。制御系からのON/OFF信号は現状送らない。将来的に制御を導入する場合は、ESP32からPWM信号を出力し、適切な変換回路を介して可変電源のアナログ入力に接続する。この場合、信号線は光絶縁するのが好ましい。

\subsection{非常停止回路}

非常停止（E-Stop）スイッチはモータドライバのENラインにプルダウンまたはプルアップして接続し、押下時にモータ駆動を即時停止させる。加えて、制御系電源を遮断する回路を組み込むことで、より高い安全性を確保できる。屋外用のE-StopスイッチはIP65以上の防水/防塵仕様かつB接点のものを採用するのが好ましい。この場合､ESP32からのEN出力は適切な抵抗器を介して接続する､または絶縁する必要がある｡

\subsection{ノイズ対策と配線整理}

モータ線と信号線は物理的に離して配線する。屋外用ケーブルを用いる場合も、必要に応じてシールドケーブルやフェライトコアを追加し、ノイズの進入を防ぐ。配線はケーブルクランプや配線ダクトで固定し、振動による断線を防止する。

\subsection{接続テストと初動確認}

全配線が完了したら、以下の手順で動作確認を行う。

\begin{enumerate}
\item モータが正方向・逆方向に正しく回転するか確認する。X/A軸が逆方向である可能性があるため､Y軸アームが取り外されている状態であることが好ましい｡
\item リミットスイッチ未接続の前提で動作範囲を確認する。
\item スピンドルを別系統で安全に起動確認する。
\item CNCjsから手動ジョグ操作を行い、座標指令と実際の移動方向が一致しているか確認する。
\end{enumerate}

\subsection{トラブルシュート}

モータが動作しない場合は、ドライバ入力電圧、フォトカプラ入力電圧、GPIO出力状態を順に確認する。ノイズによる誤動作が疑われる場合は、信号線シールド強化や配線経路変更を行う。スピンドルが起動しない場合は、独立電源側のスイッチと安全回路を確認する。
オシロスコープがあるのが好ましいが､電圧計単体でも信号の確認は行えるので､適切なツールを用いること｡


\section{制御パラメータ}

CNCマシンの動作精度および加工効率は、制御パラメータの適切な設定によって大きく左右される。制御パラメータとは、モータ駆動信号の特性や移動時の加減速、座標系の基準、機構のガタ（バックラッシュ）補正など、機械の運動挙動を規定するものである。本節では、FluidNCを用いた本環境における主要な制御パラメータの設定方針を述べる。

\subsection{ステップパルスと加速度設定}
ステッピングモータは、ドライバから与えられるパルス信号に同期して回転する。このパルス信号の幅（pulse width）および間隔は、モータの応答性と最大速度に影響する。パルス幅が短すぎるとモータが信号を取りこぼし、長すぎると最高速度が低下する他､誤作動の可能性が高まる。初期設定ではモータドライバの推奨値を用い、安定動作を確認した上で調整を行うと良い。大抵の場合､初期設定で問題ない｡

加速度（acceleration）は、停止状態から目標速度に到達するまでの速度増加率である。過大な加速度設定は脱調を引き起こし、過小な設定は加工時間を延長させる。初期設定では低めに設定し、加工中に問題が発生しない範囲で徐々に引き上げる。

\subsection{機械原点およびワーク原点の設定}
機械原点（Machine Zero）は、CNC機械が認識する絶対座標系の基準位置である。一般に、各軸のリミットスイッチに到達した位置を原点とする。電源投入後は原点復帰（homing）を行い、機械座標を確定させるのが基本である。現状､リミットスイッチが存在しないので無意味な概念である｡

ワーク原点（Work Zero）は、加工対象物（ワーク）の座標系の基準位置である。加工する図面の基準点（例：材料左下角や中央）を決定し、その位置を機械に記憶させる。FluidNCではG54などのワーク座標系コマンドを用いて設定する事ができるが､手動で設定するのが好ましい。

\subsection{バックラッシュ補正}
バックラッシュは、送りねじやギアの機構的遊びによって発生する位置誤差である。本環境では、CAMソフトのオフセット設定により補正を行う。補正値は以下の方法で求める。

\begin{enumerate}
    \item 長辺と短辺(例:30*40)を持つ長方形の輪郭を切削する。
    \item 実測値と設計値を比較し、各軸ごとの寸法誤差を算出する。
    \item CAMソフトにバックラッシュ補正オフセットを記入し、再度切削して誤差が最小になるよう調整する。
\end{enumerate}

この工程を繰り返し、可能な限りバックラッシュの影響を低減する。

\subsection{加工前の確認事項}
制御パラメータを適切に設定しても、加工対象が傾いていたり固定が不十分であれば、寸法精度は保証されない。加工を行う前に、以下を必ず確認すること。
\begin{itemize}
    \item ワーク設置面が水平であること（水平器等で確認）
    \item ワークが加工中に動かないよう確実に固定されていること（ネジ等の締結状態を確認）
\end{itemize}
フラットベッドは湿度変化に伴う木材の反り・歪み、および過切削による表面凹凸の発生が避けられない構造である。このため、年に一度程度を目安に水平出しを実施し、加工精度を維持することが望ましい。
\subsection{フラットベッドの水平出し}

本機のフラットベッドはスタイロフォーム製であり、湿度による変形や過切削による凹凸の影響を受けやすい。そのため、年に一度程度を目安に水平出しを行い、加工精度を維持することが望ましい。対象ベッドの標準サイズは幅910~mm、長さ1820~mmである。

\subsubsection*{作業目的}
水平出しは、ベッド全体を浅く切削して平坦性を回復させる作業である。スタイロフォーム製ベッドでは切り込み量を3～5~mm程度まで許容できるため、凹凸の修正を一度で行える場合が多い。

\subsubsection*{事前準備}
\begin{itemize}
    \item 加工前に必ずベッド上の釘やネジ、その他金属部品をすべて撤去する。これを怠ると工具の破損や事故につながる。
    \item 面取り用またはサーフェスカッター（直径16～25~mm程度、2～3枚刃超硬）を準備する。
    \item 集塵機やエアブローにより切削粉の排出経路を確保する。
\end{itemize}

\subsubsection*{手順}
\begin{enumerate}
    \item \textbf{原点設定}：ベッド左前端をワーク原点とする。Z原点は適切に設定する。
    \item \textbf{加工範囲設定}：実寸に基づき、X方向910~mm、Y方向1820~mmの範囲を指定する。安全マージンとして外周20~mm程度を追加してもよい。
    \item \textbf{切削条件設定}：
    \begin{itemize}
        \item 切り込み量（Z方向）：3.0～5.0~mm／パス
        \item 送り速度：500～800~mm/min
        \item スピンドル回転数：10,000～16,000~rpm
    \end{itemize}
    \item \textbf{パス生成}：CAMソフトにて全面を覆う走査パスを作成する。各パスの間隔は工具径の80～90\%程度とし、パスをオーバーラップさせることで段差を低減する。X方向とY方向の交互切削を推奨するが､非常に時間がかかるのでやらなくても良い。
    \item \textbf{切削実行}：初回は小さい領域を浅めに加工し、ベッド全体の高低差を確認する。必要に応じて深さを追加して全面を削る。
    \item \textbf{仕上げ確認}：加工後、凹凸が許容範囲内であれば作業を終了する。
\end{enumerate}

\subsubsection*{注意事項}
\begin{itemize}
    \item 切り込み量が大きい場合でも、ベッド全体を一度で削り切らず、2～3回に分けて行う方が精度を確保しやすい。
    \item 水平出し後は必ず座標系および固定治具の高さを再設定する。
\end{itemize}
適切な設定を行わないと､30時間以上かかる可能性がある｡太いエンドミルを使うことや､サーフェスカッターを購入することを検討すると良い｡
｢裏技｣として､6～8時間程度でこれを完了させる方法が存在するが､再現性に乏しいこと､あまり好ましくない方法であることからここには記載しない｡

\section{おまけ}
\subsection*{用語集（機械／加工）}
\begin{description}
  \item[ステッピングモーター] パルス信号で一定角度ずつ回転するモーター。位置制御に用いる。
  \item[ステッピングドライバ] ステッピングモーターを駆動する回路／モジュール。電流制御やマイクロステップ生成を行う。
  \item[NEMA17・NEMA23] モーターの取付け寸法規格。数字はフレーム外形（インチ）。NEMA17≈1.7 in（約42 mm）、NEMA23≈2.3 in（約57 mm）。
  \item[バイポーラ] モーター巻線に双方向の電流を流す駆動方式。一般にユニポーラより高トルクだが電流制御が必要。
  \item[リードスクリュー] 回転を直線運動に変えるねじ機構。
  \item[マイクロステップ] 巻線電流を細かく制御して1ステップを更に分割する駆動。滑らかさ・振動低減に有効（絶対精度は機械剛性や負荷に依存）。
  \item[保持トルク] 通電して静止を保てる最大トルク。大きいほど外力に強い。
  \item[脱調] 指令ステップと実際の回転がずれる現象。過負荷・加減速過大・共振などが原因。
  \item[共振] 機構の固有振動数と駆動周波数が一致して振動が増える現象。速度帯の回避や減衰で対策。
  \item[バックラッシュ] ねじやギアの遊びによる方向反転時のガタ。オフセット補正やプリロードで低減。
  \item[リミットスイッチ] 移動端を検出する機械スイッチ。原点復帰や過走行防止に用いる。
  \item[NC（常閉）接点] 通常は導通し、作動で開放する接点。断線を検知しやすい。
  \item[Zプローブ] 工具先端のZ=0位置（ワーク上面など）を自動検出する仕組み。
  \item[スピンドル] 工具を回転させる主軸（モーター）。回転数や剛性が切削品質に影響。
  \item[エンドミル] 側面・底面で切削できる回転工具。材質・刃数・コーティングで用途が分かれる。
  \item[サーフェスカッター] ベッドや材料の面出し（平面出し）に使う広幅工具。
  \item[送り速度] 工具とワークの相対移動速度（mm/min）。切削負荷や仕上げ面に影響。
  \item[ツール長補正] 工具ごとの長さ差をZオフセットで補正する機能（TLO）。
  \item[ツイストペア（線）] 2本の導線を撚って外来ノイズを相殺する配線方法。
  \item[フェライトコア] ケーブルに装着して高周波ノイズを減衰させる磁性体部品。
  \item[ケーブルクランプ] ケーブルを固定し、引張応力や振動から保護する部品。
  \item[配線ダクト] ケーブルを収めて整理する樹脂製トラフ（スリット入りも多い）。
\end{description}

\subsection*{用語集（電気／信号）}
\begin{description}
  \item[STEP] ステッピングモーターの回転指令パルス信号。
  \item[DIR] ステッピングモーターの回転方向を指定する信号。
  \item[EN] モーター駆動の有効／無効を切り替える信号（Enable）。
  \item[GPIO] 汎用入出力ピン（General Purpose Input/Output）。
  \item[UART（TX/RX）] シリアル通信方式の一種。TXは送信、RXは受信。
  \item[フォトカプラ] 光を介して信号を伝える絶縁素子。ノイズ耐性・安全性向上に使う。
  \item[GND] 電気回路の基準電位（グラウンド）。
  \item[PWM] パルス幅変調。デジタル信号のON/OFF比でアナログ量を表現。
  \item[DIPスイッチ] 小型のレバー式切り替えスイッチ。設定変更に使う。
  \item[ストラッピングピン] 起動時の設定を決定するための固定配線端子。
  \item[ENライン] Enable信号線。機器や回路の動作を有効化する。
\end{description}

\subsection*{用語集（CNC固有）}
\begin{description}
  \item[G-code] CNC機械を制御するための標準的な命令コード。
  \item[機械原点（Machine Zero）] 機械の基準座標系の原点位置。
  \item[ワーク原点（Work Zero）] 加工対象物に対する基準位置。
  \item[Homing（原点復帰）] リミットスイッチ等を使って機械原点に戻す動作。
  \item[ジョグ操作] 手動(ソフト上)で軸を少しずつ動かす操作。
  \item[ソフトリミット] 制御ソフト上で設定された移動範囲制限。
\end{description}

\subsection*{用語集（安全／規格）}
\begin{description}
  \item[E-Stop（非常停止）] 緊急時に機械の動作を即時停止させる装置（Emergency Stop）。
  \item[安全カバー] 作業者を切削くずや工具から保護する覆い。安全規格に準拠する場合も多い。
  \item[IP65] 国際防水・防塵規格。粉塵の侵入を完全防止し、あらゆる方向からの噴流水にも耐える。
  \item[B接点] 作動すると導通が切れる接点（NCと同義）。安全検出回路で使用されることが多い。
  \item[ヒヤリハット] 事故には至らないが、危険につながりかけた事象の記録・共有。
\end{description}

\subsection*{用語集（数量／単位／制御パラメータ）}
\begin{description}
  \item[steps per mm] 1 mm移動するのに必要なステップ数。機構寸法とマイクロステップ設定で決まる。
  \item[max rate] 最大移動速度。加工や機構に応じて設定する。
  \item[acceleration] 加速度。加減速のスムーズさや脱調防止に影響する。
  \item[rpm] 回転毎分（revolutions per minute）。モーターやスピンドルの回転速度の単位。
  \item[mm/min] 移動速度や送り速度の単位（毎分ミリメートル）。
\end{description}



\begin{thebibliography}{999}
\bibitem{fluidnc-installer} FluidNC Web Installer（公式）.
\bibitem{fluidnc-config} FluidNC Config file Overview（公式Wiki）.
\bibitem{fluidnc-motion} FluidNC Motion Setup（公式Wiki）.
\bibitem{espressif-gpio} Espressif ESP-IDF: GPIO \& RTC GPIO（公式）.
\bibitem{espressif-datasheet} Espressif ESP32 Series Datasheet（公式）.
\bibitem{rpi-imager-wifi} Raspberry Pi Documentation: Wi-Fi/Imager Advanced Settings（公式）.
\bibitem{rpi-overlay-wp} Raspberry Pi Whitepaper: Making a more resilient file system（公式）.
\bibitem{cncjs-install} CNCjs Installation / Raspberry Pi Setup Guide（公式）.
\bibitem{cncjs-dockerfile} CNCjs 公式Dockerfile（master）.
\bibitem{dockerhub} Docker Hub: cncjs/cncjs（公式イメージ）.
\end{thebibliography}

\end{document}